pro slbh_fc,a_t,a_g,x_t,x_g,nu_vv,q_vv,ad_vv,aq_vv
common sblhfc_data,fc
;
; Do we need to define the data array?
;
if n_elements(fc) eq 0 then begin
    fc = fltarr(16,42)
    ; Franck-Condon values from Benesch 1966?
    fc[*,00] = [.4308e-1,.1155e-0,.1707e-0,.1832e-0,.1600e-0,.1217e-0,.8296e-1,.5262e-1,$
                .3153e-1,.1784e-1,.9812e-2,.5187e-2,.2733e-2,.1408e-2,.7071e-3,.3585e-3]
    fc[*,01] = [.1526e-0,.1931e-0,.9710e-1,.1232e-1,.6199e-2,.4655e-1,.8456e-1,.9919e-1,$
                .9235e-1,.7332e-1,.5294e-1,.3506e-1,.2236e-1,.1359e-1,.7888e-2,.4551e-2]
    fc[*,02] = [.2495e-0,.7983e-1,.3407e-2,.7583e-1,.9643e-1,.4658e-1,.4521e-2,.5751e-2,$
                .3372e-1,.6077e-1,.7366e-1,.7087e-1,.6034e-1,.4631e-1,.3265e-1,.2223e-1]
    fc[*,03] = [.2502e-0,.5680e-3,.1084e-0,.6864e-1,.4799e-3,.3444e-1,.7273e-1,.5616e-1,$
                .1805e-1,.1087e-3,.9922e-2,.3194e-1,.5118e-1,.5979e-1,.5754e-1,.5001e-1]
    fc[*,04] = [.1728e-0,.9050e-1,.8488e-1,.4177e-2,.7834e-1,.5591e-1,.2471e-2,.1783e-1,$
                .5400e-1,.5440e-1,.2737e-1,.4209e-2,.1319e-2,.1448e-1,.3169e-1,.4488e-1]
    fc[*,05] = [.8679e-1,.1882e-0,.4928e-3,.9685e-1,.3555e-1,.9399e-2,.6401e-1,.4583e-1,$
                .3650e-2,.1001e-1,.3999e-1,.4862e-1,.3228e-1,.1029e-1,.1516e-3,.4744e-2]
    fc[*,06] = [.3306e-1,.1755e-0,.6907e-1,.6357e-1,.1909e-1,.7899e-1,.1323e-1,.1418e-1,$
                .5550e-1,.3844e-1,.4293e-2,.5673e-2,.2973e-1,.4277e-1,.3379e-1,.1578e-1]
    fc[*,07] = [.9684e-2,.1014e-0,.1681e-0,.5541e-3,.9785e-1,.6290e-2,.4320e-1,.5590e-1,$
                .3734e-2,.1759e-1,.4821e-1,.3286e-1,.4797e-2,.3054e-2,.2170e-1,.3622e-1]
    fc[*,08] = [.2210e-2,.4104e-1,.1612e-0,.8533e-1,.3279e-1,.5127e-1,.5269e-1,.1899e-2,$
                .5251e-1,.3658e-1,.4515e-3,.1914e-1,.4236e-1,.2914e-1,.5344e-2,.1354e-2]
    fc[*,09] = [.3933e-3,.1201e-1,.9090e-1,.1668e-0,.1244e-1,.8354e-1,.3557e-2,.6886e-1,$
                .1475e-1,.1433e-1,.5006e-1,.2239e-1,.4316e-4,.1997e-1,.3729e-1,.2643e-1]
    fc[*,10] = [.5505e-4,.2674e-2,.3469e-1,.1405e-0,.1161e-0,.5291e-2,.8222e-1,.1194e-1,$
                .3569e-1,.4834e-1,.8097e-3,.2554e-1,.4284e-1,.1397e-1,.5796e-3,.1922e-1]
    fc[*,11] = [.7030e-5,.4502e-3,.9607e-2,.7124e-1,.1644e-0,.4687e-1,.4631e-1,.3804e-1,$
                .5004e-1,.2825e-2,.5136e-1,.2318e-1,.1516e-2,.3161e-1,.3462e-1,.8689e-2]
    fc[*,12] = [.7162e-6,.5839e-4,.1958e-2,.2434e-1,.1136e-0,.1472e-0,.3962e-2,.8192e-1,$
                .2884e-2,.6449e-1,.8016e-2,.2276e-1,.4472e-1,.7767e-2,.6902e-2,.3280e-1]
    fc[*,13] = [.1389e-9,.7219e-5,.2931e-3,.5959e-2,.4912e-1,.1481e-0,.9858e-1,.7572e-2,$
                .7844e-1,.8218e-2,.4149e-1,.3678e-1,.8364e-3,.3673e-1,.3025e-1,.1238e-2]
    fc[*,14] = [.3433e-8,.6019e-6,.3332e-4,.1056e-2,.1433e-1,.8134e-1,.1602e-0,.4170e-1,$
                .4214e-1,.4236e-1,.3926e-1,.9269e-2,.5113e-1,.8838e-2,.1166e-1,.3827e-1]
    fc[*,15] = [.1174e-7,.1114e-6,.2869e-5,.1367e-3,.2991e-2,.2880e-1,.1165e-0,.1431e-0,$
                .5531e-2,.7491e-1,.8037e-2,.6049e-1,.9423e-3,.3611e-1,.3192e-1,.3129e-4]
    fc[*,16] = [.1391e-7,.4265e-8,.2305e-6,.1435e-4,.4451e-3,.7055e-2,.5072e-1,.1453e-0,$
                .1027e-0,.3162e-2,.8054e-1,.1508e-2,.5228e-1,.2005e-1,.1017e-1,.4212e-1]
    fc[*,17] = [.1293e-7,.1190e-7,.3516e-8,.1252e-5,.4841e-4,.1210e-2,.1454e-1,.7830e-2,$
                .1575e-0,.5420e-1,.2840e-1,.5681e-1,.2248e-1,.2414e-1,.4302e-1,.1461e-3]
    fc[*,18] = [.9650e-7,.2830e-7,.1265e-7,.1937e-6,.3776e-5,.1451e-3,.2881e-2,.2636e-1,$
                .1077e-0,.1496e-0,.1526e-1,.6110e-1,.2239e-1,.4884e-1,.2421e-2,.4644e-1]
    fc[*,19] = [.1626e-7,.1048e-7,.3261e-8,.4969e-8,.2697e-6,.1402e-4,.3933e-3,.6026e-2,$
                .4383e-1,.1363e-0,.1216e-0,.5740e-4,.7943e-1,.1555e-2,.5884e-1,.3951e-2]
    fc[*,20] = [.3021e-7,.6822e-9,.1027e-7,.3211e-8,.6947e-9,.1068e-5,.3832e-4,.9357e-3,$
                .1146e-1,.6649e-1,.1544e-0,.8120e-1,.1047e-1,.7303e-1,.5302e-2,.4449e-1]
    ;
    ; Approximate band origin wavelengths
    fc[*,21] = [1450,1416,1384,1354,1325,1299,1273,1249,1227,1206,1185,1166,1148,1130,1114,1098]
    fc[*,22] = [1501,1464,1430,1398,1368,1339,1312,1287,1263,1240,1219,1199,1179,1161,1144,1127]
    fc[*,23] = [1555,1515,1479,1444,1412,1382,1353,1326,1301,1277,1254,1233,1212,1193,1174,1157]
    fc[*,24] = [1612,1570,1530,1493,1459,1427,1396,1367,1340,1315,1291,1268,1247,1226,1207,1188]
    fc[*,25] = [1672,1627,1585,1545,1508,1474,1441,1411,1382,1355,1329,1305,1282,1261,1240,1221]
    fc[*,26] = [1736,1688,1642,1600,1560,1523,1489,1456,1426,1397,1370,1344,1320,1297,1275,1255]
    fc[*,27] = [1805,1752,1703,1658,1616,1576,1539,1504,1472,1441,1412,1385,1359,1335,1312,1290]
    fc[*,28] = [1878,1821,1768,1719,1674,1631,1592,1555,1520,1487,1456,1427,1400,1374,1350,1327]
    fc[*,29] = [1956,1895,1838,1785,1736,1690,1648,1608,1571,1536,1503,1472,1443,1416,1390,1366]
    fc[*,30] = [2040,1973,1911,1854,1801,1752,1707,1664,1624,1587,1552,1519,1488,1459,1432,1406]
    fc[*,31] = [2130,2057,1990,1928,1871,1818,1769,1723,1681,1641,1603,1568,1536,1505,1476,1448]
    fc[*,32] = [2227,2147,2074,2007,1945,1888,1835,1786,1740,1698,1658,1620,1585,1552,1521,1492]
    fc[*,33] = [2331,2244,2165,2092,2025,1963,1906,1853,1804,1758,1715,1675,1638,1602,1569,1538]
    fc[*,34] = [2444,2349,2262,2182,2109,2042,1981,1923,1870,1821,1775,1732,1692,1655,1620,1587]
    fc[*,35] = [2567,2462,2366,2279,2200,2127,2060,1998,1941,1888,1839,1793,1750,1710,1673,1638]
    fc[*,36] = [2700,2584,2479,2384,2297,2218,2145,2078,2017,1960,1906,1857,1811,1768,1728,1691]
    fc[*,37] = [2846,2717,2601,2497,2402,2315,2236,2164,2097,2035,1978,1925,1876,1830,1787,1747]
    fc[*,38] = [3005,2862,2734,2619,2514,2420,2333,2255,2182,2115,2054,1997,1944,1894,1848,1806]
    fc[*,39] = [3181,3021,2878,2751,2636,2532,2438,2352,2273,2201,2134,2073,2016,1963,1913,1867]
    fc[*,40] = [3375,3195,3036,2894,2768,2653,2550,2456,2370,2292,2220,2153,2092,2035,1982,1933]
    fc[*,41] = [3590,3387,3209,3051,2911,2785,2671,2568,2474,2389,2311,2239,2172,2111,2054,2001]
endif
;
; Since the number of vibrational levels wasn't passed
; as a parameter, figure it out from other parameters
;
nv = n_elements(a_g(*,0))
nvv = n_elements(x_g(*,0))
;
; Generate wavenumbers for band origins and
; Franck-Condon array for all band transitions
;
nu_vv = (a_t + [a_g(*,0)])#replicate(1.,nvv) $
         - replicate(1.,nv)#(x_t+[x_g(*,0),4])
q_vv = fc(0:nv-1,0:nvv-1)
;
; Generate the band transition probabilities
; From experiment and theory
;
ad_vv = 4.373e-11*nu_vv^3*q_vv     ;magnetic dipole
aq_vv = 5.435e-22*nu_vv^5*q_vv     ;electric quadrupole
return
end
